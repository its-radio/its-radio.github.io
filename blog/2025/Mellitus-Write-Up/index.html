<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> HTB Write-Up | Medium Sherlock | Mellitus | Edmund Hughes </title> <meta name="author" content="Edmund Hughes"> <meta name="description" content="A write-up for Hack The Box's forensics challenge 'Mellitus'. This challenge focuses primarily on memory forensics, with the evidence consisting solely of a forensic memory dump from a targeted machine."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?a27bdb63fce2b854f99c6ed2387b5fa8"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://its-radio.github.io/blog/2025/Mellitus-Write-Up/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <img src="/assets/img/logo/radio-logo-512.png" alt="Logo" style="height: 40px; margin-right: 0px; margin-bottom: 15px;"> <img src="/assets/img/logo/name-gradient.png" alt="Logoname" style="height: 25px; margin-right: 10px; margin-bottom: 8px;"> <span class="font-weight-bold">Edmund</span> Hughes </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">HTB Write-Up | Medium Sherlock | Mellitus</h1> <p class="post-meta"> Created in February 22, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/forensics"> <i class="fa-solid fa-hashtag fa-sm"></i> forensics</a>   <a href="/blog/tag/medium"> <i class="fa-solid fa-hashtag fa-sm"></i> medium</a>   <a href="/blog/tag/sherlock"> <i class="fa-solid fa-hashtag fa-sm"></i> sherlock</a>   <a href="/blog/tag/hackthebox"> <i class="fa-solid fa-hashtag fa-sm"></i> HackTheBox</a>   <a href="/blog/tag/memory"> <i class="fa-solid fa-hashtag fa-sm"></i> memory</a>   <a href="/blog/tag/volatility"> <i class="fa-solid fa-hashtag fa-sm"></i> volatility</a>   ·   <a href="/blog/category/write-ups"> <i class="fa-solid fa-tag fa-sm"></i> Write-Ups</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <style>.small-margin>*{margin-bottom:.1rem}</style> <h2 id="introduction">Introduction</h2> <p>This is a write-up for Hack The Box’s Sherlock challenge, <strong>Mellitus</strong>. This Sherlock is rated as <strong>Medium</strong>, but I’ll try to keep the write-up beginner friendly and approachable. I’ll cover most methods thoroughly and explain the reasoning for decisions that I make. If there is anything you don’t understand or if you have any specific questions, please feel free to reach out to me on X. Seriously! I’ll actually try to help you out.</p> <h2 id="tools--setup">Tools &amp; Setup</h2> <p>For this investigation, I exclusively used a machine running Fedora 40, meaning that I had access to all the standard linux tools like <code class="language-plaintext highlighter-rouge">grep</code>, <code class="language-plaintext highlighter-rouge">strings</code>, etc. Of course, there are Windows equivalents for most of these tools, and it is possible to repeat any of these steps on Windows.</p> <p>The primary forensics tools I relied on for this challenge was the <a href="https://volatilityfoundation.org/" rel="external nofollow noopener" target="_blank">Volatility Framework</a>–an invaluable, open-source memory forensics tool. I mainly used <a href="https://github.com/volatilityfoundation/volatility3" rel="external nofollow noopener" target="_blank">Volatility 3</a> but it may also be useful to have <a href="https://github.com/volatilityfoundation/volatility" rel="external nofollow noopener" target="_blank">Volatility 2</a> on hand in some cases.</p> <p>I am working on my own Volatility cheatsheet which I may post later, but for now let me point you to this excellent <a href="https://blog.onfvp.com/post/volatility-cheatsheet/" rel="external nofollow noopener" target="_blank">cheatsheet by Ashley Peterson</a>. It shows how to use a bunch of the most useful Volatility plugins in both Volatility 2 and Volatility 3.</p> <h2 id="starting-out">Starting Out</h2> <p>I always start by thoroughly reading the description. It reads:</p> <p><em>You’ve been a SOC analyst for the last 4 years but you’ve been honing your incident response skills! It’s about time you bite the bullet and go for your dream job as an Incident Responder as that’s the path you’d like your career to follow. Currently you are going through the interview process for a medium size incident response internal team and the cocky interviewing responder has given you a tough technical challenge to test your memory forensics aptitude. Can you get all the questions right and secure the job?</em></p> <p>Okay, not much in there except that we are looking at memory forensics and it’s likely that the evidence is going to be similar to something a responder might encounter in an incident response.</p> <h2 id="downloading-mellituszip-and-decompressing-it">Downloading mellitus.zip and decompressing it</h2> <p>For whatever reason I’ve had trouble with the <code class="language-plaintext highlighter-rouge">unzip</code> command handling the evidence archives from HTB, so I always use <code class="language-plaintext highlighter-rouge">7z</code> to decompress them. Other compression tools probably work, but <code class="language-plaintext highlighter-rouge">7z</code> is a popular and easy choice. Keep in mind that you’ll need to enter a password in order to decompress the archive. You can get the password on HTB as shown in the image below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/1.png" sizes="95vw"></source> <img src="/assets/img/mellitus/1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 1 </div> <p>Decompress the archive as shown and take a look at what’s inside. You can use (also shown in Fig. 2):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7z x mellitus.zip
</code></pre></div></div> <p>The evidence consists of 2 files (Fig. 2):</p> <ol> <li>memory_dump.vmem This is a memory image created by VMWare virtualization software. That is, it’s one to one copy of the RAM on a VMWare virtual machine at the time the image was taken. It should contain the bulk of the important information.</li> <li>memory_dump.vmsn This is a file that contains snapshot information about the VM. I am not too familiar with analyzing these forensically, but VM snapshots contain information about the current state of the machine, configuration information, etc. It could prove useful.</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/2.png" sizes="95vw"></source> <img src="/assets/img/mellitus/2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 2 </div> <p><strong>Note:</strong> <em>I like to save my volatility output so that I can easily grep through it later, but I don’t want to grep the entire image each time. to facilitate this, I’ve organized my challenge directory like this:</em></p> <pre><code class="language-plain">mellitus
    output
        &lt;My outputs go here&gt;
        &lt;I'm mostly working from this dir&gt;
    vmems
        memory_dump.vmem
        memory_dump.vmsn
</code></pre> <p><em>It will make sense as we work through the problems.</em></p> <p>Now that we have seen the evidence, let’s jump into Task 1.</p> <h2 id="task-1-what-was-the-time-on-the-system-when-the-memory-was-captured">Task 1: What was the time on the system when the memory was captured?</h2> <p>Use the <code class="language-plaintext highlighter-rouge">windows.info</code> plugin to view the image’s metadata.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.info | <span class="nb">tee </span>info.vol
</code></pre></div></div> <p>The use of <code class="language-plaintext highlighter-rouge">tee</code> allows me to view the output in real time and write it to a file at the same time. The system time at the time of capture is shown in the output of the <code class="language-plaintext highlighter-rouge">windows.info</code> plugin (Fig. 3).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/3.png" sizes="95vw"></source> <img src="/assets/img/mellitus/3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 3 </div> <h2 id="task-2-what-is-the-ip-address-of-the-attacker">Task 2: What is the IP address of the attacker?</h2> <p>There are two command and useful network-related plugins for volatility: <code class="language-plaintext highlighter-rouge">windows.netscan</code> and <code class="language-plaintext highlighter-rouge">windows.netstat</code>. Netscan returns information about both active and closed connections, while netstat is generally less comprehensive. They are both useful, but I went with netscan first.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.netscan | <span class="nb">tee </span>netscan.vol
</code></pre></div></div> <p>If you aren’t used to looking at these, the output can look a bit daunting, but it really isn’t that bad. Right now, all we’re looking for is something out of the ordinary. One relevant aspect of a connection is the port used on each machine. In this case, one of the connections to a remote machine is targeting port 4545 (Fig. 4), which is not typically associated with any common service. This alone doesn’t confirm malicious behavior, but it sticks out.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/4.png" sizes="95vw"></source> <img src="/assets/img/mellitus/4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 4 </div> <p>Trying out the IP as the answer confirms that it is, in fact, the answer.</p> <h3 id="task2a">Confirming the IP is malicious</h3> <p>In real life we’d need to confirm this IP address another way, so let’s take a minute and do that before moving on. One easy thing to do when you have a suspected malicious IP is just extract the strings from the memory dump and grep for the IP. This casts a fairly wide net and is definitely worth doing.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings ../vmems/memory_dump.vmem | <span class="nb">grep </span>192.168.157.151
</code></pre></div></div> <p>There is… a lot of malicious stuff going on in the output. I’m not even going to include the entire thing, but just in Figure 5, there are several signs of malicious activity. It’s all suspicious, but downloading “scvhost.exe”, a close misspelling of the native Windows executable “svchost.exe” is egregiously malicious. It may as well be screaming that it’s malicious.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/5.png" sizes="95vw"></source> <img src="/assets/img/mellitus/5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 5 </div> <h2 id="task3">Task 3: What is the name of the strange process?</h2> <p>Based on the download in Figure 5, I’d like to place a bet that it’ll be “<code class="language-plaintext highlighter-rouge">scvhost.exe</code>”, but let’s take a look at the processes to find out. Here we can use one of a few plugins. Really you can choose from <code class="language-plaintext highlighter-rouge">windows.pslist</code>, <code class="language-plaintext highlighter-rouge">windows.psscan</code>, and <code class="language-plaintext highlighter-rouge">windows.pstree</code>. These are each slightly different, but I tend to like the output from <code class="language-plaintext highlighter-rouge">pstree</code> because it includes the full file path of the running executables. The output can be hard to parse in a terminal though due to the length of the lines, so I’ll just <code class="language-plaintext highlighter-rouge">tee</code> it to a file like usual, open it in a text editor and zoom out a bit (Fig. 6).</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.pstree | <span class="nb">tee </span>pstree.vol
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/6.png" sizes="95vw"></source> <img src="/assets/img/mellitus/6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 6 </div> <p>In Figure 6, we can see that <code class="language-plaintext highlighter-rouge">scvhost.exe</code> did indeed run on the machine as PID 11156. Not only is it misspelled, but it’s running out of user BantingFG’s Downloads folder. Even if it were named correctly, <code class="language-plaintext highlighter-rouge">svchost.exe</code> running from a downloads folder is highly suspect. It should only ever run from its designated locations like <code class="language-plaintext highlighter-rouge">System32</code>, <code class="language-plaintext highlighter-rouge">SysWOW64</code>, etc.</p> <p>It’s also interesting to note that it is running as a child of Powershell PID 6772. Moving back another layer, we can see that powershell PID 6772 and some other processes are children of PID 1424. I ran the <code class="language-plaintext highlighter-rouge">windows.pslist</code> plugin for easier visual parsing in the terminal, then grepped for “1424”. PID 1424 turns out to be explorer.exe and it has some other interesting children (Fig. 7).</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.pslist | <span class="nb">tee </span>pslist.vol
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep </span>1424 pslist.vol
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/7.png" sizes="95vw"></source> <img src="/assets/img/mellitus/7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 7 </div> <p>Pretty much all of these processes (Fig. 7) warrant further investigation, but at first glance I’m especially curious about the <code class="language-plaintext highlighter-rouge">cmd.exe</code>, <code class="language-plaintext highlighter-rouge">FTK Imager.exe</code>, <code class="language-plaintext highlighter-rouge">python.exe</code>, <code class="language-plaintext highlighter-rouge">powershell.exe</code>, and <code class="language-plaintext highlighter-rouge">chrome.exe</code>.</p> <p>But I digress. The answer to task 3 is <code class="language-plaintext highlighter-rouge">scvhost.exe</code>. We’ll come back to these, but for now let’s move on to Task 4.</p> <h2 id="task-4-what-is-the-pid-of-the-process-that-launched-the-malicious-binary">Task 4: What is the PID of the process that launched the malicious binary?</h2> <p>I already found this in the previous task. It was launched by <code class="language-plaintext highlighter-rouge">powershell.exe</code> PID 6772.</p> <h2 id="task-5-what-was-the-command-that-got-the-malicious-binary-onto-the-machine">Task 5: What was the command that got the malicious binary onto the machine?</h2> <p>I also already found this. It’s the <code class="language-plaintext highlighter-rouge">curl</code> command from <a href="#task2a">Task 2</a>. In Task 2, I found it by dumping the strings from the image and grepping for the malicious IP, but there are other ways to find this command too. For example:</p> <p>Use the <code class="language-plaintext highlighter-rouge">windows.memmap</code> plugin to dump the memory related to powershell PID 6772. It will create a file called <code class="language-plaintext highlighter-rouge">pid.6772.dmp</code></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.memmap <span class="nt">--dump</span> <span class="nt">--pid</span> 6772
</code></pre></div></div> <p>Dump the strings from the <code class="language-plaintext highlighter-rouge">pid.6772.dmp</code> into a new file.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings pid.6772.dmp <span class="o">&gt;&gt;</span> 6772.strings
</code></pre></div></div> <p>Then open 6772.strings in a text editor and search for words related to that the misspelled malicious file <code class="language-plaintext highlighter-rouge">scvhost.exe</code>. There are hundreds of results, but in truth, it doesn’t take that long to quickly glance through 250+ matches. Or if you chose to search for ‘downloads’ (since it’s running from the Downloads folder), you’ll hit a great result after only 11 matches (Fig. 8)</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/8.png" sizes="95vw"></source> <img src="/assets/img/mellitus/8.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 8 </div> <p>In Figure 8, we can observe the attacker repeatedly trying and failing to download their payload before eventually succeeding and running it.</p> <h2 id="task-6-the-attacker-attempted-to-gain-entry-to-our-host-via-ftp-how-many-users-did-they-attempt">Task 6: The attacker attempted to gain entry to our host via FTP. How many users did they attempt?</h2> <p>Again, I already caught some of this back in <a href="#task2a">Task 2</a>, but we need to revisit it to count usernames. From the output I looked at in Task 2, it looks like there are 3 unique usernames (Fig. 9).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/9.png" sizes="95vw"></source> <img src="/assets/img/mellitus/9.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 9 </div> <p>Since there is a lot of output, I added one more grep to narrow it down. This takes the output from Task 2 and then greps for lines containing either ‘password’ or ‘user’ since both types of lines can contain usernames in this context.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings ../vmems/memory_dump.vmem | <span class="nb">grep </span>192.168.157.151 | <span class="nb">grep</span> <span class="nt">-iE</span> <span class="s2">"password|user"</span>
</code></pre></div></div> <p>This narrowed the output to less than one page (Fig. 10) and I still didn’t see other usernames, so the answer should be 3.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/10.png" sizes="95vw"></source> <img src="/assets/img/mellitus/10.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 10 </div> <h2 id="task-7-what-is-the-full-url-of-the-last-website-the-attacker-visited">Task 7: What is the full URL of the last website the attacker visited?</h2> <p>Back to the <code class="language-plaintext highlighter-rouge">chrome.exe</code> PID 8048 spawned from the malicious <code class="language-plaintext highlighter-rouge">explorer.exe</code> PID 1424 (see the end of <a href="#task3">Task 3</a>). I’m targeting its history database, which will be a file that it should have loaded into memory. To dump the files related to its PID, first I’ll make a directory for them to go in:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>chrome8048
</code></pre></div></div> <p>Then use the <code class="language-plaintext highlighter-rouge">windows.dumpfile</code> plugin to dump the related files:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem <span class="nt">-o</span> chrome8048 windows.dumpfile <span class="nt">--pid</span> 8048
</code></pre></div></div> <p>Identify the history database. This command (below) also just checks their file types after finding them. It is a SQLite database as shown in Figure 11:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find chrome8048 <span class="nt">-iname</span> <span class="s2">"*hist*"</span> <span class="nt">-exec</span> file <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/11.png" sizes="95vw"></source> <img src="/assets/img/mellitus/11.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 11 </div> <p>I’m using <a href="https://sqlitebrowser.org/" rel="external nofollow noopener" target="_blank">sqlitebrowser</a> to open and browse through the history DB (Fig. 12). The correct file to use is <code class="language-plaintext highlighter-rouge">file.0xc40aa9259df0.0xc40aa4ec6be0.SharedCacheMap.History.vacb</code>. Open it, go to the section indicated in Figure 12 and look for URLs the attacker might have visited. They were having trouble downloading their file, so the searches and sites towards the bottom look likely. One turns out to be correct.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/12.png" sizes="95vw"></source> <img src="/assets/img/mellitus/12.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 12 </div> <h2 id="task-8-what-is-the-affected-users-password">Task 8: What is the affected user’s password?</h2> <p>For this one, I used the <code class="language-plaintext highlighter-rouge">windows.hashdump</code> plugin to extract any user hashes that existed in the memory image (Fig. 13).</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.hashdump | <span class="nb">tee </span>hashdump.vol
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/13.png" sizes="95vw"></source> <img src="/assets/img/mellitus/13.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 13 </div> <p>The user who seems most affected by all of this seems to be BantingFG, since the malicious file is in his downloads folder, etc. I threw his NT Hash into <a href="https://crackstation.net/" rel="external nofollow noopener" target="_blank">CrackStation</a> and it immediately returned a result (Fig. 14)</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/14.png" sizes="95vw"></source> <img src="/assets/img/mellitus/14.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 14 </div> <h2 id="task-9-there-is-a-flag-hidden-related-to-pid-5116-can-you-confirm-what-it-is">Task 9: There is a flag hidden related to PID 5116. Can you confirm what it is?</h2> <p>PID 5116 turns out to be the instance of <code class="language-plaintext highlighter-rouge">mspaint.exe</code> that was spawned by <code class="language-plaintext highlighter-rouge">powershell.exe</code> PID 6772 (Fig. 15).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/15.png" sizes="95vw"></source> <img src="/assets/img/mellitus/15.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 15 </div> <p>Since this is MS Paint, it seems likely that the hidden flag might be something drawn on the screen. In that case, we’d need to access whatever part of memory the data for the drawing is stored in. I don’t know which of the files, if any, that would be from the <code class="language-plaintext highlighter-rouge">windows.dumpfile</code> output, but whatever memory that we need will definitely be included in a <code class="language-plaintext highlighter-rouge">windows.memmap</code> dump of the entire process’s memory.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vol3 <span class="nt">-f</span> ../vmems/memory_dump.vmem windows.memmap <span class="nt">--dump</span> <span class="nt">--pid</span> 5116
</code></pre></div></div> <p>As in Task 3, this should result in an output file called <code class="language-plaintext highlighter-rouge">pid.5116.dmp</code>. Now… How can we view the image that was displayed on the screen to the user while they were useing MS Paint? I hadn’t done this type of extraction before so googled about it and read <a href="https://w00tsec.blogspot.com/2015/02/extracting-raw-pictures-from-memory.html" rel="external nofollow noopener" target="_blank">one</a> or <a href="https://beguier.eu/nicolas/articles/security-tips-2-volatility-gimp.html" rel="external nofollow noopener" target="_blank">two</a> blog posts about it.</p> <p>Read the linked articles too for a better understanding, but the basic idea is to just open the entire process dump in <a href="https://www.gimp.org/" rel="external nofollow noopener" target="_blank">GIMP</a> as “raw image data” and then manually search through the raw data until you find something that looks like an image.</p> <p>After some fiddling around in GIMP, I was able to produce the answer with the following procedure:</p> <ol> <li>From the base settings, increase the <em>Offset</em> slider until you see something recognizable (Fig. 16)</li> <li>Increase the <em>Width</em> slider until it becomes readable (Fig. 17)</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/16.png" sizes="95vw"></source> <img src="/assets/img/mellitus/16.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 16 </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 small-margin"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mellitus/17.png" sizes="95vw"></source> <img src="/assets/img/mellitus/17.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 17 </div> <p>It’s upside down, but clearly reads <em>you_Foundme!</em></p> <h2 id="conclusion">Conclusion</h2> <p>This Sherlock was a nice refresher on memory forensics. I prefer the challenges that require more varied techniques, but it’s also fun to focus in on one skill sometimes. I liked the fact that the authors rewarded knowledge of specific techniques or plugins (like the windows.hashdump plugin), and also rewarded very general searches (like grepping the entire forensic image for the malicious IP). The bonus question was really interesting as well since I had never encountered that technique before. It makes me wonder what images I could have retrieved from other forensic images I’ve analyzed.</p> <p>Thanks for reading! If you have any questions or comments, feel free to reach out or follow <a href="https://x.com/its_rad_io" rel="external nofollow noopener" target="_blank">me on X</a></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/raspberryos_fan_control/">Fan Service</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/chrome_hx_volatility_plugin/">Chrome Browser History Plugin for Volatility 3</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Nuts-Write-Up/">HTB Write-Up | Medium Sherlock | Nuts</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/latus-write-up/">HTB Write-Up | Hard Sherlock | Latus</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Compromised-Write-Up/">HTB Write-Up | Easy Sherlock | Compromised</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Edmund Hughes. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-blog",title:"blog",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-about",title:"about",description:"",section:"Navigation",handler:()=>{window.location.href="/about/"}},{id:"nav-people",title:"people",description:"",section:"Navigation",handler:()=>{window.location.href="/people/"}},{id:"post-fan-service",title:"Fan Service",description:"The fan on my RaspberryPi NAS & PiHole wouldn't stop running, so I built a custom solution.",section:"Posts",handler:()=>{window.location.href="/blog/2025/raspberryos_fan_control/"}},{id:"post-chrome-browser-history-plugin-for-volatility-3",title:"Chrome Browser History Plugin for Volatility 3",description:"A discription of a plugin I wrote for Volatility 3. The plugin searches for, extracts, and parses Google Chrome history databases in forensic memory images.",section:"Posts",handler:()=>{window.location.href="/blog/2025/chrome_hx_volatility_plugin/"}},{id:"post-htb-write-up-medium-sherlock-mellitus",title:"HTB Write-Up | Medium Sherlock | Mellitus",description:"A write-up for Hack The Box's forensics challenge 'Mellitus'. This challenge focuses primarily on memory forensics, with the evidence consisting solely of a forensic memory dump from a targeted machine.",section:"Posts",handler:()=>{window.location.href="/blog/2025/Mellitus-Write-Up/"}},{id:"post-htb-write-up-medium-sherlock-nuts",title:"HTB Write-Up | Medium Sherlock | Nuts",description:"A write-up for Hack The Box's forensics challenge 'Nuts'. This challenge focuses primarily on file forensics, with the evidence consisting solely of a forensic image of a targetted filesystem.",section:"Posts",handler:()=>{window.location.href="/blog/2025/Nuts-Write-Up/"}},{id:"post-htb-write-up-hard-sherlock-latus",title:"HTB Write-Up | Hard Sherlock | Latus",description:"A write-up for Hack The Box's forensics challenge 'Latus'",section:"Posts",handler:()=>{window.location.href="/blog/2024/latus-write-up/"}},{id:"post-htb-write-up-easy-sherlock-compromised",title:"HTB Write-Up | Easy Sherlock | Compromised",description:"A beginner-friendly write-up for Hack The Box's forensics challenge 'Compromised'",section:"Posts",handler:()=>{window.location.href="/blog/2024/Compromised-Write-Up/"}},{id:"post-how-to-implement-cmmc-at-your-organization",title:"How To Implement CMMC At Your Organization",description:"Basic considerations for what needs to be done to implement CMMC at any organization.",section:"Posts",handler:()=>{window.location.href="/blog/2024/CMMC-2.0-Implementation/"}},{id:"post-cmmc-2-0-is-important-for-the-dib-the-u-s-military-and-tax-payers-like-you-and-me",title:"CMMC 2.0 Is Important For The DIB, The U.S. Military, and Tax Payers...",description:"A short history of CMMC and the differences between CMMC 1.0 & 2.0",section:"Posts",handler:()=>{window.location.href="/blog/2024/CMMC-2.0-Summary/"}},{id:"post-how-chinese-spies-hacked-u-s-state-department-emails-threat-modeling-for-apts-and-aptaas",title:"How Chinese Spies Hacked U.S. State Department Emails--Threat Modeling for APTs and APTaaS...",description:"An informal discussion of Antique Typhoon's attack on Microsoft systems and email accounts associated with U.S Government personnel. A brief discussion of threat modelling and APTaaS.",section:"Posts",handler:()=>{window.location.href="/blog/2024/storm-0558-APT/"}},{id:"post-the-legal-implications-of-antique-typhoon-39-s-intrusion-into-microsoft-amp-the-u-s-state-department",title:"The Legal Implications of Antique Typhoon's Intrusion Into Microsoft & The U.S. State...",description:"An informal discussion of Antique Typhoon's attack on Microsoft systems and email accounts associated with U.S State Department employees as well as the laws that were likely broken along the way.",section:"Posts",handler:()=>{window.location.href="/blog/2024/storm-0558-laws/"}},{id:"post-why-all-the-cybersecurity-laws-why-now",title:"Why All The Cybersecurity Laws? Why Now?",description:"A short piece I wrote for a Cyberlaw class on the importance of cybersecurity laws in the modern day.",section:"Posts",handler:()=>{window.location.href="/blog/2024/importance-of-cyberlaw/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%69%74%73%72%61%64.%69%6F.%70%72%69%76%61%63%79@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>